<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>走れ文学 - スタート画面</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body>
    <audio id="start-bgm" loop autoplay>
        <source src="{{ url_for('static', filename='assets/sounds/start.mp3') }}" type="audio/mpeg">
    </audio>

    <div class="literary-background">
        {{ background_text }}
    </div>

    <div class="start-container">
        <h1>走れ文学</h1>
        <div class="menu-item">
            <a href="{{ url_for('start_game') }}" onclick="fetch('/api/reset_story', {method: 'POST'})">はじめから</a>
        </div>
        <div class="menu-item">
            <a href="{{ url_for('synopsis') }}">あらすじ</a>
        </div>
        <div class="menu-item">
            <a href="{{ url_for('operate') }}">遊び方</a>
        </div>
    </div>

    <script>
        // ページ読み込み時に再生を試みる（あらすじ画面からの戻り対策）
        window.addEventListener('DOMContentLoaded', () => {
            const audio = document.getElementById('start-bgm');
            if (audio) {
                audio.play().catch(err => {
                    console.log("Autoplay waiting for user interaction");
                });
            }
        });

        window.addEventListener('click', () => {
            const audio = document.getElementById('start-bgm');
            if (audio && audio.paused) {
                audio.play();
            }
        }, { once: true }); // 最初の1クリック目だけ実行

        localStorage.removeItem("chosenIcon");
    </script>
</body>
</html>